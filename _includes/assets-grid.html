{%- comment -%} Folder-driven gallery (GitHub Pages safe & simple) {%- endcomment -%}

{%- assign folder = include.folder | default: page.assets -%}
{%- if folder == nil or folder == "" -%}
  <p><em>Missing <code>assets</code> folder path (set in page front matter or pass as include param).</em></p>
{%- endif -%}
{%- assign folder = folder | append: "/" | replace: "//","/" -%}

{%- assign count = 0 -%}
<ul class="gallery-grid">
  {%- for f in site.static_files | sort: "name" -%}
    {%- assign p = f.path -%}
    {%- assign ext = f.extname | downcase -%}
    {%- if p contains folder and (ext == ".svg" or ext == ".png" or ext == ".jpg" or ext == ".jpeg" or ext == ".webp") -%}
      {%- assign count = count | plus: 1 -%}
      {%- assign base = f.name | split: "." | first -%}
      {%- assign title_from_name = base | split: "_" | last | replace: "-", " " -%}
      <li class="gallery-item">
        {%- if include.link_full -%}<a href="{{ p | relative_url }}" target="_blank" rel="noopener">{%- endif -%}
          <img src="{{ p | relative_url }}" alt="{{ title_from_name | escape }}" loading="lazy" decoding="async">
        {%- if include.link_full -%}</a>{%- endif -%}
        {%- if include.captions -%}<figcaption class="gallery-caption">{{ title_from_name }}</figcaption>{%- endif -%}
      </li>
    {%- endif -%}
  {%- endfor -%}
</ul>

{%- if count == 0 -%}
  <p>No images found in <code>{{ folder }}</code>.</p>
{%- endif -%}

<style>
  .gallery-justified{ display:flex; flex-wrap:wrap; gap:1rem; align-items:flex-start; margin:1rem 0 2rem; }
  .gallery-item{ border:1px solid color-mix(in oklab, currentColor 12%, transparent);
                 border-radius:12px; overflow:hidden;
                 background: color-mix(in oklab, Canvas 98%, currentColor 2%);
                 transition: transform .12s ease, box-shadow .12s ease; }
  .gallery-item:hover{ transform: translateY(-2px); box-shadow: 0 6px 18px rgba(0,0,0,.12); }
  .gallery-item img{ width:100%; height:auto; display:block; }
  .gallery-caption{ padding:.6rem .8rem; font-size:.95rem; opacity:.8; }
</style>
